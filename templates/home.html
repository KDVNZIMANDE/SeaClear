{% extends "base.html" %}

{% block title %}SeaClear - Home{% endblock %}

{% block extra_css %}
<style>
  .beach-card {
    transition: transform 0.3s ease-in-out;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    width: 150%;
    max-width: 1000px; /* Adjusted width for cards */
    margin-bottom: 20px; /* Added margin to separate cards */
  }

  .beach-card:hover {
    transform: scale(1.05);
  }

  .beach-image {
    height: 200px; /* Increased image height */
    object-fit: cover;
  }

  .news-widget {
    margin-bottom: 30px;
  }

  .map-widget {
    height: 200px; /* Shortened height of the map */
    border-radius: 15px; /* Rounded corners */
    overflow: hidden; /* Ensure map corners are rounded */
  }

  /* Leaflet CSS */
  #map {
    width: 100%;
    height: 70%;
    border-radius: 15px; /* Rounded corners */
  }

  /* Carousel Styles */
  .carousel-item {
    position: relative;
    height: 300px; 
    border-radius: 15px; /* Rounded corners */
    overflow: hidden; /* Ensure carousel corners are rounded */
  }

  .carousel-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-caption {
    background-color: rgba(0, 0, 0, 0.5);
    color: #fff;
    padding: 15px;
    border-radius: 5px;
    bottom: 20px;
    left: 15px;
    right: 15px;
  }

  .carousel-caption h5 {
    font-size: 1.5rem;
    font-weight: bold;
  }

  .carousel-caption p {
    font-size: 1rem;
  }

  .carousel-control-prev, .carousel-control-next {
    display: none;
  }

  /* Beach Card Styles */
  .beach-list {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 20px; /* Space between beach cards */
  }

  .status-open {
    background-color: #28a745;
    color: #fff;
    padding: 5px 10px;
    border-radius: 5px;
  }

  .status-closed {
    background-color: #dc3545;
    color: #fff;
    padding: 5px 10px;
    border-radius: 5px;
  }

  /* Container for Beach Cards and Map */
  .beach-map-container {
    display: flex;
    gap: 20px;
    justify-content: flex-start; /* Align items to the left */
  }

  .beach-list {
    flex: 2;
  }

  .map-widget-container {
    flex: 1;
    max-width: 350px; /* Increase maximum width of the map */
  }
</style>
{% endblock %}

{% block content %}
<!-- Welcome and News Carousel -->
<div id="carouselWelcome" class="carousel slide news-widget" data-ride="carousel" data-interval="5000">
  <div class="carousel-inner">
    <!-- Welcome Message as First Carousel Item -->
    <div class="carousel-item active">
      <div class="jumbotron text-center">
        <h1 class="display-4">Welcome to SeaClear</h1>
        <p class="lead">Explore and contribute to the health of our beaches.</p>
        <hr class="my-4" />
        <p>View beach conditions, leave comments, and help keep our shores clean.</p>
      </div>
    </div>

    <!-- News Carousel Items -->
    {% for news in news_items[:3] %}
    <div class="carousel-item">
      <a href="{{ news.link }}" target="_blank">
        <img src="{{ url_for('static', filename='images/' + news.image) }}" class="d-block w-100" alt="{{ news.title }}" />
        <div class="carousel-caption d-none d-md-block">
          <h5>{{ news.title }}</h5>
          <p>{{ news.content }}</p>
        </div>
      </a>
    </div>
    {% endfor %}

    <!-- Link to Full News Page -->
    <div class="carousel-item">
      <a href="{{ url_for('news_page') }}">
        <img src="{{ url_for('static', filename='images/default_news.jfif') }}" class="d-block w-100" alt="More News" />
        <div class="carousel-caption d-none d-md-block">
          <h5>More News</h5>
          <p>See all the latest news and updates on our dedicated news page.</p>
        </div>
      </a>
    </div>
  </div>
</div>

<!-- Beach Cards and Map Widget -->
<div class="beach-map-container">
  <!-- Popular Beaches -->
  <div class="beach-list">
    <h2 class="mb-4">Popular Beaches</h2>
    {% for beach in beaches %}
    <div class="beach-list-item">
      <div class="card beach-card">
        <img src="{{ url_for('static', filename='images/' + beach.get('image', 'default_beach.jpg')) }}" class="card-img-top beach-image" alt="{{ beach.get('Location', 'Beach') }}" />
        <div class="card-body">
          <h5 class="card-title">{{ beach.get('name', 'Unknown Beach') }}</h5>
          <p class="card-text">
            <strong>Status:</strong>
            <span class="badge {{ 'status-open' if beach.get('status') == 'OPEN' else 'status-closed' }}">
              {{ beach.get('status', 'Unknown') }}
            </span><br />
            <strong>Grade:</strong> {{ beach.get('grade', 'N/A') }}
          </p>
          <a href="{{ url_for('beach_detail', beach_id=beach.id) }}" class="btn btn-primary">Show Details</a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Map Widget -->
  <div class="map-widget-container">
    <div id="map" class="map-widget"></div>
  </div>
</div>

{% if not beaches %}
<div class="alert alert-info" role="alert">
  No beaches found. Check back later for updates!
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script>
  // Initialize and add the map using Leaflet
  var map = L.map("map").setView([-34.397, 150.644], 10);

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
  }).addTo(map);

  L.marker([-34.397, 150.644])
    .addTo(map)
    .bindPopup("Example Beach")
    .openPopup();
</script>
{% endblock %}
