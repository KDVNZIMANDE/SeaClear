{% extends "base.html" %}

{% block title %}SeaClear - Home{% endblock %}

{% block extra_css %}
<style>
  .beach-card {
    transition: transform 0.3s ease-in-out;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  .beach-card:hover {
    transform: scale(1.05);
  }

  .beach-image {
    height: 200px;
    object-fit: cover;
  }

  .news-widget {
    margin-bottom: 30px;
  }

  .map-widget {
    height: 400px;
    margin-bottom: 30px;
  }

  /* Leaflet CSS */
  #map {
    width: 100%;
    height: 400px;
  }

  /* Carousel Styles */
  .carousel-item {
    position: relative;
    height: 400px;
  }

  .carousel-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-caption {
    background-color: rgba(0, 0, 0, 0.5); /* Dark background with transparency */
    color: #fff; /* White text color */
    padding: 15px;
    border-radius: 5px;
    bottom: 20px;
    left: 15px;
    right: 15px;
  }

  .carousel-caption h5 {
    font-size: 1.5rem;
    font-weight: bold;
  }

  .carousel-caption p {
    font-size: 1rem;
  }

  .carousel-control-prev, .carousel-control-next {
    display: none; /* Hide the controls */
  }

  /* Beach Card Styles */
  .beach-list-item {
    margin-bottom: 20px;
  }

  .beach-list-item img {
    width: 100%;
    height: auto;
  }
</style>
{% endblock %}

{% block content %}
<!-- Welcome and News Carousel -->
<div id="carouselWelcome" class="carousel slide news-widget" data-ride="carousel" data-interval="5000">
  <div class="carousel-inner">
    <!-- Welcome Message as First Carousel Item -->
    <div class="carousel-item active">
      <div class="jumbotron text-center">
        <h1 class="display-4">Welcome to SeaClear</h1>
        <p class="lead">Explore and contribute to the health of our beaches.</p>
        <hr class="my-4" />
        <p>View beach conditions, leave comments, and help keep our shores clean.</p>
      </div>
    </div>

    <!-- News Carousel Items -->
    {% for news in news_items[:3] %}
    <div class="carousel-item">
      <a href="{{ news.link }}" target="_blank">
        <img src="{{ url_for('static', filename='images/' + news.image) }}" class="d-block w-100" alt="{{ news.title }}" />
        <div class="carousel-caption d-none d-md-block">
          <h5>{{ news.title }}</h5>
          <p>{{ news.content }}</p>
        </div>
      </a>
    </div>
    {% endfor %}

    <!-- Link to Full News Page -->
    <div class="carousel-item">
      <a href="{{ url_for('news_page') }}">
        <img src="{{ url_for('static', filename='images/default_news.jfif') }}" class="d-block w-100" alt="More News" />
        <div class="carousel-caption d-none d-md-block">
          <h5>More News</h5>
          <p>See all the latest news and updates on our dedicated news page.</p>
        </div>
      </a>
    </div>
  </div>
</div>

<!-- Map Widget -->
<div id="map" class="map-widget"></div>

<h2 class="mb-4">Popular Beaches</h2>

<div class="row">
  {% for beach in beaches %}
  <div class="col-md-12 mb-4 beach-list-item">
    <div class="card beach-card">
      <img src="{{ url_for('static', filename='images/' + beach.get('image', 'default_beach.jpg')) }}" class="card-img-top beach-image" alt="{{ beach.get('Location', 'Beach') }}" />
      <div class="card-body">
        <h5 class="card-title">{{ beach.get('name', 'Unknown Beach') }}</h5>
        <p class="card-text">
          <strong>Grade:</strong> {{ beach.get('grade', 'N/A') }}<br />
          <strong>Enterococci Count:</strong> {{ beach.get('enterococcicount', 'N/A') }}<br />
          <strong>Last Updated:</strong> {{ beach.get('date', 'N/A') }}<br />
          <strong>Status:</strong>
          <span class="badge badge-{{ 'success' if beach.get('status') == 'SAFE' else 'danger' }}">
            {{ beach.get('status', 'Unknown') }}
          </span>
        </p>
        <a href="{{ url_for('beach_detail', beach_id=beach.id) }}" class="btn btn-primary">View Details</a>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

{% if not beaches %}
<div class="alert alert-info" role="alert">
  No beaches found. Check back later for updates!
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script>
  // Initialize and add the map using Leaflet
  var map = L.map("map").setView([-34.397, 150.644], 10);

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
  }).addTo(map);

  L.marker([-34.397, 150.644])
    .addTo(map)
    .bindPopup("Example Beach")
    .openPopup();
</script>
{% endblock %}
